library(ggtern)
library(ggpomological)
theme_set(theme_pomological())

library(plyr)
data(USDA)

usda_1927 <- tribble(
   ~ Clay,
   ~ Sand,
   ~ Silt,
   ~ Label,
   1.00,
   0.00,
   0.00,
   "Clay",
   0.50,
   0.50,
   0.00,
   "Clay",
   0.30,
   0.50,
   0.20,
   "Clay",
   0.30,
   0.20,
   0.50,
   "Clay",
   0.50,
   0.00,
   0.50,
   "Clay",
   0.50,
   0.50,
   0.00,
   "Sandy\nClay",
   0.30,
   0.50,
   0.20,
   "Sandy\nClay",
   0.30,
   0.70,
   0.00,
   "Sandy\nClay",
   0.50,
   0.00,
   0.50,
   "Silty\nClay",
   0.30,
   0.20,
   0.50,
   "Silty\nClay",
   0.30,
   0.00,
   0.70,
   "Silty\nClay",
   0.20,
   0.80,
   0.00,
   "Sandy Clay\nLoam",
   0.30,
   0.70,
   0.00,
   "Sandy Clay\nLoam",
   0.30,
   0.50,
   0.20,
   "Sandy Clay\nLoam",
   0.20,
   0.50,
   0.30,
   "Sandy Clay\nLoam",
   0.30,
   0.50,
   0.20,
   "Clay Loam",
   0.20,
   0.50,
   0.30,
   "Clay Loam",
   0.20,
   0.30,
   0.50,
   "Clay Loam",
   0.30,
   0.20,
   0.50,
   "Clay Loam",
   0.20,
   0.30,
   0.50,
   "Silty Clay\nLoam",
   0.30,
   0.20,
   0.50,
   "Silty Clay\nLoam",
   0.30,
   0.00,
   0.70,
   "Silty Clay\nLoam",
   0.20,
   0.00,
   0.80,
   "Silty Clay\nLoam",
   0.00,
   1.00,
   0.00,
   "Sand",
   0.00,
   0.80,
   0.20,
   "Sand",
   0.20,
   0.80,
   0.00,
   "Sand",
   0.20,
   0.80,
   0.00,
   "Sandy Loam",
   0.00,
   0.80,
   0.20,
   "Sandy Loam",
   0.00,
   0.50,
   0.50,
   "Sandy Loam",
   0.20,
   0.50,
   0.30,
   "Sandy Loam",
   0.20,
   0.50,
   0.30,
   "Loam",
   0.00,
   0.50,
   0.50,
   "Loam",
   0.20,
   0.30,
   0.50,
   "Loam",
   0.00,
   0.50,
   0.50,
   "Silt Loam",
   0.20,
   0.30,
   0.50,
   "Silt Loam",
   0.20,
   0.00,
   0.80,
   "Silt Loam",
   0.00,
   0.00,
   1.00,
   "Silt Loam"
)

labels <-    usda_1927 %>%
   group_by(Label) %>%
   dplyr::summarise(Clay = mean(Clay),
                    Sand = mean(Sand),
                    Silt = mean(Silt))

historical_plot <-
   ggplot(data = usda_1927, aes(y = Clay, x = Sand, z = Silt)) +
   coord_tern(L = "x", T = "y", R = "z") +
   geom_polygon(
      aes(fill = Label),
      alpha = 0,
      size = 0.5,
      color = '#a89985',
      show.legend = FALSE
   ) +
   geom_text(
      data = labels,
      aes(label = Label),
      color = '#6b452b',
      size = 2.5,
      family = "Courier"
   ) +
   ggtitle("Davis and Bennett, 1927, Fig. 2") +
   theme_showsecondary() +
   theme_clockwise() +
   theme_showarrows() +
   theme(legend.position = "none",
         text = element_text(family = "Courier"))

paint_pomological(historical_plot, res = 110, outfile = "plots/plot3.png")

