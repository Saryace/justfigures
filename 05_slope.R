library(tidyverse)

theme_set(theme_bw())

soil_slope <- tribble(
  ~ soil_id,
  ~ top,
  ~ bottom,
  ~ RF,
  ~ distance,
  "summit",
  -0.5,
  0,
  12,
  150,
  "summit",
  0,
  17,
  12,
  150,
  "summit",
  17,
  44,
  7,
  150,
  "summit",
  44,
  55,
  3,
  150,
  "summit",
  55,
  75,
  2,
  150,
  "summit",
  75,
  250,
  NA,
  150,
  "shoulder",
  -30,
  0,
  NA,
  450,
  "shoulder",
  0,
  10,
  10,
  450,
  "shoulder",
  10,
  24,
  7,
  450,
  "shoulder",
  24,
  65,
  5,
  450,
  "shoulder",
  65,
  90,
  1,
  450,
  "shoulder",
  90,
  190,
  NA,
  450,
  "backslope",
  -75,
  0,
  NA,
  650,
  "backslope",
  0,
  19,
  4,
  650,
  "backslope",
  19,
  34,
  4,
  650,
  "backslope",
  34,
  77,
  2,
  650,
  "backslope",
  77,
  91,
  2,
  650,
  "backslope",
  91,
  111,
  1,
  650,
  "backslope",
  111,
  250,
  NA,
  650,
  "footslope",
  -150,
  0,
  NA,
  950,
  "footslope",
  0,
  19,
  4,
  950,
  "footslope",
  19,
  44,
  3,
  950,
  "footslope",
  44,
  77,
  2,
  950,
  "footslope",
  77,
  91,
  1,
  950,
  "footslope",
  91,
  100,
  NA,
  950
)

slope_plot <- soil_slope  %>% group_by(soil_id) %>%
  mutate(altitude =  top - bottom)

plot5 <- ggplot(data = slope_plot, aes(distance,  altitude , fill = RF)) +
  geom_col(position = "stack", width = 50) +
  geom_text(aes(label = soil_id,
                vjust = -0.25),
            data = filter(slope_plot, top < 0)) +
  scale_fill_continuous(
    low = "bisque3",
    high = "chocolate3",
    guide = "colorbar",
    na.value = "transparent"
  ) +
  ggtitle("Landscape positions") +
  theme_bw() +
  labs(x = "distance from the top", y = "relative altitude", fill = "Rock\nfragments (%)") +
  theme(
    panel.background = element_rect(
      fill = "beige",
      colour = "grey",
      size = 1,
      linetype = "solid"
    ),
    axis.text.y = element_blank(),
    axis.ticks.y = element_blank(),
    panel.border = element_rect(
      colour = "black",
      fill = NA,
      size = 5
    ),
    plot.title = element_text(
      size = 24,
      family = "Tahoma",
      face = "bold"
    ),
    text = element_text(family = "Tahoma", size = 24),
    legend.position = "bottom"
  )

ggsave("plots/plot5.png")

